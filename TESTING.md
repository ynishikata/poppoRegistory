# 動作テストガイド

このドキュメントでは、`test_checklist.md`に基づいて動作テストを実行する方法を説明します。

## テスト前の準備

### 1. バックエンドの起動

```bash
cd /Users/y/go/src/github.com/ynishikata/poppoRegistory

# 環境変数を設定（.envファイルに記述済みであることを確認）
# SUPABASE_JWT_SECRET=...
# OPENAI_API_KEY=... (会話機能をテストする場合)

go run .
```

バックエンドが `http://localhost:8080` で起動することを確認してください。

### 2. フロントエンドの起動

別のターミナルで:

```bash
cd /Users/y/go/src/github.com/ynishikata/poppoRegistory/frontend

# 環境変数を設定（frontend/.envファイルに記述済みであることを確認）
# VITE_SUPABASE_URL=...
# VITE_SUPABASE_ANON_KEY=...

npm run dev
```

フロントエンドが `http://localhost:5173` で起動することを確認してください。

## テスト手順

### 認証機能のテスト

1. **新規登録**
   - ブラウザで `http://localhost:5173` を開く
   - メールアドレスとパスワードを入力して「新規登録」をクリック
   - 登録成功後、自動的にログインされることを確認
   - 既に登録されているメールアドレスで再度登録を試み、エラーが表示されることを確認

2. **ログイン**
   - ログアウト後、正しいメールアドレスとパスワードでログインできることを確認
   - 間違ったメールアドレス/パスワードでログインを試み、エラーが表示されることを確認

3. **ログアウト**
   - ログアウトボタンをクリックしてログアウトできることを確認
   - ログアウト後、ぬいぐるみ一覧ページにアクセスできないことを確認

### ぬいぐるみ管理機能のテスト

1. **新規登録**
   - 名前、種類、お迎え日、写真を入力して登録できることを確認
   - 写真なしでも登録できることを確認
   - 名前が空の場合、エラーメッセージが表示されることを確認
   - 登録後、一覧に表示されることを確認

2. **一覧表示**
   - ログイン後、自分のぬいぐるみ一覧が表示されることを確認
   - 別のユーザーでログインし、他のユーザーのぬいぐるみが表示されないことを確認

3. **編集**
   - ぬいぐるみの情報を編集できることを確認
   - 写真を変更できることを確認

4. **削除**
   - ぬいぐるみを削除できることを確認
   - 削除後、一覧から消えることを確認

5. **詳細表示**
   - ぬいぐるみの詳細ページが表示されることを確認
   - 会話履歴が表示されることを確認
   - 会話履歴を編集できることを確認

### 会話機能のテスト

1. **会話履歴の更新**
   - 会話履歴を入力して保存できることを確認
   - 保存後、詳細ページに反映されることを確認

2. **チャット機能**
   - 「話す」ボタンをクリックすると、LLMが応答を生成することを確認
   - 会話履歴に基づいた応答が生成されることを確認
   - エラーが発生した場合、適切なエラーメッセージが表示されることを確認

### エラーハンドリングのテスト

1. **認証エラー**
   - ログインしていない状態でAPIを呼び出すと、適切なエラーメッセージが表示されることを確認
   - トークンの有効期限が切れた場合、適切なエラーメッセージが表示されることを確認

2. **バリデーションエラー**
   - 必須項目が空の場合、適切なエラーメッセージが表示されることを確認
   - 無効なIDでアクセスした場合、適切なエラーメッセージが表示されることを確認

## テスト結果の記録

`test_checklist.md`の各項目にチェックを入れて、テスト結果を記録してください。

## トラブルシューティング

### バックエンドが起動しない
- `.env`ファイルが正しく設定されているか確認
- ポート8080が使用されていないか確認

### フロントエンドが起動しない
- `frontend/.env`ファイルが正しく設定されているか確認
- `npm install`が実行されているか確認

### 認証エラーが発生する
- Supabaseの設定（URL、ANON_KEY、JWT_SECRET）が正しいか確認
- ブラウザの開発者ツールでネットワークタブを確認し、リクエストヘッダーにAuthorizationが含まれているか確認

### 画像が表示されない
- バックエンドの`uploads/`ディレクトリが作成されているか確認
- 画像URLが正しく生成されているか確認（ブラウザの開発者ツールで確認）

